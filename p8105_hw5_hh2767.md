p8105\_hw5\_hh2767
================
Haoran Hu
2018-11-5

Problem 1
=========

Read in file names and files
----------------------------

In the following chunk, I will:

-   Start with a dataframe containing all file names, using list.file function

-   Use purrr::map to read in the data and save it as a new variable in the dataframe

``` r
exp_files = list.files(".\\data\\data_exp") %>% 
  strsplit(split = " ") %>% 
  tibble() %>% 
  rename(., file_name = .) %>% 
  mutate(data = map(.x = file_name, ~read_csv(str_c(".\\data\\data_exp\\", .x)))) 

head(exp_files)
```

    ## # A tibble: 6 x 2
    ##   file_name data            
    ##   <list>    <list>          
    ## 1 <chr [1]> <tibble [1 x 8]>
    ## 2 <chr [1]> <tibble [1 x 8]>
    ## 3 <chr [1]> <tibble [1 x 8]>
    ## 4 <chr [1]> <tibble [1 x 8]>
    ## 5 <chr [1]> <tibble [1 x 8]>
    ## 6 <chr [1]> <tibble [1 x 8]>

So far, I have created a dataframe called "files". It includes two columns:"file\_name" and "data". The "file\_name" column shows all the file names, and the "data" colume contains the data in each file corresponding to those file names.

Tidy the results
----------------

Next, I will:

-   Show arms and IDs of subjects in the dataframe.

-   Tidy the weekly observation data.

-   Recode the data into informative forms. For example, changing "con" into "control".

``` r
exp_data = 
  exp_files %>% 
  separate(file_name, into = c("arm", "subject_id"), sep = "_") %>% 
  separate(subject_id, into = c("subject_id", "remove"), sep = "\\.") %>% 
  select(-remove) %>% 
  mutate(., arm = recode(.$arm, con = "control", exp = "experiment")) %>% 
  unnest() %>% 
  gather(key = week, value = value, week_1:week_8) %>% 
  mutate(week = str_replace(week, "week_", " "),  
         subject = str_c(arm, "_", subject_id)) %>% 
  select(subject, arm, week, value)

str(exp_data)
```

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    160 obs. of  4 variables:
    ##  $ subject: chr  "control_01" "control_02" "control_03" "control_04" ...
    ##  $ arm    : chr  "control" "control" "control" "control" ...
    ##  $ week   : chr  " 1" " 1" " 1" " 1" ...
    ##  $ value  : num  0.2 1.13 1.77 1.04 0.47 2.37 0.03 -0.08 0.08 2.14 ...

The finel dataset is a 160(rows) \* 4(cols) dataset. It contains four variables:

-   subject, which shows the ids of subjects.

-   arm, which shows whether a subject is in experimental arm or control arm

-   week, which shows the time of an observation

-   value, which shows observation value

This dataset is a tidy dataset.

Making a plot
-------------

``` r
exp_data %>% 
  ggplot(aes(x = week, y = value, group = subject, color = arm)) + 
  labs(title = "Experiment observations on each subject over time", y = "Observation value") + 
  geom_line() +
  geom_point() +
  theme_bw()  + theme(legend.position = "bottom")
```

![](p8105_hw5_hh2767_files/figure-markdown_github/unnamed-chunk-3-1.png)

From the spaghetti plot, we can see that the observation values of subjects in experimental arm is higher than that of subjects in control arm. In addition, the observation values of subjects in experimental arm kept increasing over time, while the observation values of subjects in control arm remain stable. In other words, the difference between observation value of subjects in experimental arm and that of subjects in control arm became greater over time.

Problem 2
=========

Read and describe the dataset
-----------------------------

``` r
homicide = read.csv(".\\data\\homicide-data.csv")
```

The raw dataset is a 52179(rows) \* 12(cols) dataset. The dataset contains information about 52179 homicides occured in the US. The location, time, and information of victims of each homicide are included in the dataset. The dataset also indicates whether the homicides are solved or not.

Adding variables and tidying the dataset
----------------------------------------

``` r
homicide_summary = homicide %>% 
  mutate(city_state = str_c(city, ",", state)) %>% 
  group_by(city_state) %>% 
  summarize(
    num_unsolved = sum(disposition %in% c("Open/No arrest", "Closed without arrest")),
         num_total = n()
    )
  
str(homicide_summary)
```

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    52 obs. of  3 variables:
    ##  $ city_state  : chr  "Albuquerque,NM" "Atlanta,GA" "Baltimore,MD" "Baton Rouge,LA" ...
    ##  $ num_unsolved: int  146 373 1825 196 347 310 319 206 4073 309 ...
    ##  $ num_total   : int  378 973 2827 424 800 614 521 687 5535 694 ...
